{%- liquid
    assign og_title = page_title | default: shop.name
    assign og_url = canonical_url | default: shop.url
    assign og_type = 'website'
    assign og_description = page_description | default: shop.description | default: shop.name

    if request.page_type == 'product'
      assign og_type = 'product'
    elsif request.page_type == 'article'
      assign og_type = 'article'
    elsif request.page_type == 'collection'
      assign og_type = 'product.group'
    elsif request.page_type == 'password'
      assign og_url = shop.url
    endif
  -%}  
<meta property="og:site_name" content="{{ shop.name }}">
<meta property="og:url" content="{{ og_url }}">
<meta property="og:title" content="{{ og_title | escape }}">
<meta property="og:type" content="{{ og_type }}">
<meta property="og:description" content="{{ og_description | escape }}">
<meta property="og:image:width" content="300"/> <meta property="og:image:height" content="300"/>
{%- if request.page_type == 'product' -%}
{%- assign og_type = 'product' -%}
{%- if product.images.size > 0 -%}
{%- for image in product.images limit: 3 -%}<meta property="og:image" content="https:{{ image.src | image_url: width: 300 }}">{%- endfor -%}
{%- for image in product.images limit: 3 -%}<meta property="og:image:secure_url" content="https:{{ image.src | image_url: width: 300 }}">{%- endfor -%}
{%- endif -%}

{%- elsif request.page_type == 'article' -%}
{%- assign og_type = 'article' -%}
{%- if article.image -%}
<meta property="og:image" content="https:{{ article.image | image_url: width: 300 }}">
<meta property="og:image:secure_url" content="https:{{ article.image | image_url: width: 300 }}">
{%- endif -%}

{%- elsif request.page_type == 'collection' -%}
{%- assign og_type = 'product.group' -%}
{%- if collection.image -%}
<meta property="og:image" content="https:{{ collection.image | image_url: width: 300 }}">
<meta property="og:image:secure_url" content="https:{{ collection.image | image_url: width: 300 }}">
{%- endif -%}

{%- else -%}
{%- assign og_url = shop.url -%}
<meta property="og:image" content="https:{{ page_image | image_url: width: 300 }}">
<meta property="og:image:secure_url" content="https:{{ page_image | image_url: width: 300 }}">

{%- endif -%}

{%- if request.page_type == 'product' -%}
<meta property="og:price:amount" content="{{ product.price | money_without_currency | strip_html }}">
<meta property="og:price:currency" content="{{ cart.currency.iso_code }}">
{%- endif -%}

{% unless settings.seo_microdata %}
  <script type="application/ld+json">
      {
        "@context": "http://schema.org",
        "@type": "Organization",
        "name": {{ shop.name | json }},
        {%- if section.settings.logo -%}
          {%- assign image_size = section.settings.logo.width -%}
          "logo": {{ section.settings.logo | image_url : width : image_size | prepend: "https:" | json }},
        {%- endif -%}
        "sameAs": [
          {{- settings.social_twitter_link | json -}},
          {{- settings.social_facebook_link | json -}},
          {{- settings.social_pinterest_link | json -}},
          {{- settings.social_instagram_link | json -}},
          {{- settings.social_tumblr_link | json -}},
          {{- settings.social_snapchat_link | json -}},
          {{- settings.social_youtube_link | json -}},
          {{- settings.social_vimeo_link | json -}}
        ],
        "url": {{- shop.url | append: page.url | json -}}
      }
    </script>
      {%- if request.page_type == 'index' -%}
      {%- assign potential_action_target = shop.url | append: routes.search_url | append: '?q={search_term_string}' -%}
      <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "WebSite",
          "name": {{ shop.name | json }},
          "potentialAction": {
            "@type": "SearchAction",
            "target": {{ potential_action_target | json }},
            "query-input": "required name=search_term_string"
          },
          "url": {{ shop.url | append: page.url | json }}
        }
      </script>
    {%- endif -%}
    {% if request.page_type == 'product' %}
    <script type="application/ld+json">
    {
      "@context": "http://schema.org/",
      "@type": "Product",
      "name": "{{ product.title | strip_html | escape }}",
      "url": "{{ shop.url }}{{ product.url }}",
      {% if product.featured_image %}
        "image": [
          "https:{{ product.featured_image.src | image_url }}"
        ],
      {% endif %}
      "description": "{{ product.description | strip_html | escape }}",
      {% if product.selected_or_first_available_variant.sku != blank %}
        "sku": "{{ product.selected_or_first_available_variant.sku }}",
      {% endif %}
      "brand": {
        "@type": "Thing",
        "name": "{{ product.vendor | escape }}"
      },
      {% if product.variants %}
        "offers": [
          {% for variant in product.variants %}
            {
              "@type" : "Offer",
              "availability" : "http://schema.org/{% if product.available %}InStock{% else %}OutOfStock{% endif %}",
              "price" : "{{ variant.price | divided_by: 100.00 }}",
              "priceCurrency" : "{{ shop.currency }}",
              "url" : "{{ shop.url }}{{ variant.url }}",
              "itemOffered" :
              {
                  "@type" : "Product",
                  {% if variant.image %}
                    "image": "http:{{ variant.image.src | image_url }}",
                  {% endif %}
                  {% if variant.title != blank %}
                    "name" : "{{ variant.title | strip_html | escape }}",
                  {% endif %}
                  {% if variant.sku != blank %}
                    "sku": "{{ variant.sku }}",
                  {% endif %}
                  {% if variant.weight != blank %}
                    "weight": {
                      "@type": "QuantitativeValue",
                      {% if variant.weight_unit != blank %}
                        "unitCode": "{{ variant.weight_unit }}",
                      {% endif %}
                      "value": "{{ variant.weight | weight_with_unit: variant.weight_unit }}"
                    },
                  {% endif %}
                  "url": "{{ shop.url }}{{ variant.url }}"
              }
            }{% unless forloop.last %},{% endunless %}
          {% endfor %}
        ]
      {% endif %}
    }
  </script>
      {% endif %}
      {%if request.page_type == 'blog' %}
      <script type="application/ld+json">
        {
          "@context": "http://schema.org",
          "@type": "Article",
          "articleBody": {{ article.content | strip_html | json }},
          "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": {{ shop.url | append: page.url | json }}
          },
          "headline": {{ article.title | json }},
          {% if article.excerpt != blank %}
            "description": {{ article.excerpt | strip_html | json }},
          {% endif %}
          {% if article.image %}
            {% assign image_size = article.image.width | append: 'x' %}
            "image": [
              {{ article | img_url: image_size | prepend: "https:" | json }}
            ],
          {% endif %}
          "datePublished": {{ article.published_at | date: '%Y-%m-%dT%H:%M:%SZ' | json }},
          "dateCreated": {{ article.created_at | date: '%Y-%m-%dT%H:%M:%SZ' | json }},
          "author": {
            "@type": "Person",
            "name": {{ article.author | json }}
          },
          "publisher": {
            "@type": "Organization",
            {% if settings.share_image %}
              {% assign image_size = settings.share_image.width | append: 'x' %}
              "logo": {
                "@type": "ImageObject",
                "height": {{ settings.share_image.height | json }},
                "url": {{ settings.share_image | img_url: image_size | prepend: "https:" | json }},
                "width": {{ settings.share_image.width | json }}
              },
            {% endif %}
            "name": {{ shop.name | json }}
          }
        }
        </script>
      {% endif %}
    {% endunless %}

{%- unless settings.social_twitter_link == blank -%}
<meta name="twitter:site" content="{{ settings.social_twitter_link | split: 'twitter.com/' | last | prepend: '@' }}">
{%- endunless -%}
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="{{ og_title }}">
<meta name="twitter:description" content="{{ og_description | escape }}">