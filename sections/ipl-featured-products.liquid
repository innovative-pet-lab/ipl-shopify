<style>
  .product-card {
    display: flex;
    flex-direction: column;
    justify-content: space-between;
    height: 100%;
    max-height: 430px;
    min-height: 304px;
    padding: 40px 32px;
    background: white;
    transition: transform 0.3s ease;
    border: 1px solid #73c7ad;
    overflow: hidden;
    border-radius: 16px;
  }

  .product-info {
    padding: 1rem;
    text-align: center;
    margin-top: auto;
    display: flex;
    flex-direction: column;
    justify-content: flex-end;
    height: 100%;
  }

  .product-title {
    min-height: 3em;
    display: flex;
    align-items: center;
    justify-content: center;
    text-align: center;
    font-size: 20px;
    color: #1a1a1a;
    font-weight: 700;
  }

  .ipl-featured-products {
    background-color: #f0f6f4;
  }
  .ipl-featured-products h1 {
    text-align: left;
  }
  .ipl-featured-products .container {
    max-width: 100%;
    padding-left: 7%;
    margin: 0 auto;
    padding-top: 6rem;
    padding-bottom: 6rem;
  }
  @media (min-width: 1900px) {
    .ipl-featured-products .container {
      padding-right: 12%;
      padding-left: 12%;
    }
  }
  @media (min-width: 2900px) {
    .ipl-featured-products .container {
      padding-right: 22%;
      padding-left: 22%;
    }
  }
  .hero.flex {
    display: flex;
  }
  @media (max-width: 768px) {
    .hero.flex {
      flex-wrap: wrap;
      padding: 0 1rem;
    }
    .hero {
      margin-bottom: 2rem !important;
      text-align: center;
    }
  }
  @media (max-width: 1020px) {
    .hero.flex {
      flex-wrap: wrap;
    }
    .hero {
      text-align: center;
    }
  }
  .hero {
    text-align: left;
    margin-bottom: 3rem;
  }
  .hero h1 {
    font-size: 40px;
    margin-bottom: 1rem;
    color: #1a1a1a;
    font-weight: 700;
    min-width: 494px;
  }
  .hero p {
    font-size: 24px;
    color: #333333;
    line-height: 32.78px;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .swiper {
    width: 100%;
    padding: 1rem;
    margin-bottom: 1rem;
    position: relative;
  }

  .product-card.min-height img {
    max-height: 357px;
  }
  @media (max-width: 501px) {
    .product.card.min.height img {
      max-height: 347px;
    }
  }
  @media (max-width: 500px) {
    .product-card {
      min-height: 80vw;
    }
  }

  .product-card .product-info {
    padding: 1rem;
    text-align: center;
  }

  .product-card:hover {
    background-color: #f0f6f4;
  }
  .product-card:hover img {
    transform: rotate(-10deg) scale(1.1);
    transition: transform 0.3s ease;
  }
  .product-card:hover .product-info .view-product {
    padding: 5px 28px;
    border: 2px solid #03b0a7;
    border-radius: 80px;
    background-color: #e6f7f6;
    color: #03b0a7;
  }
  .product-image {
    height: 220px; /* Consistent height */
    width: auto;
    max-width: 100%; /* Prevent overflow */
    object-fit: contain; /* Keep image proportional */
    margin: 0 auto; /* Center horizontally */
    padding: 2rem 1rem 1rem; /* Same padding as before */
    display: block;
  }

  .product-card:hover .view-product {
    color: white;
  }
  .view-product {
    display: inline-block;
    color: #2bb7a4;
    text-decoration: none;
    font-weight: 700;
    transition: color 0.2s ease;
    padding: 5px 28px;
    border: 2px solid transparent;
    font-size: 18px;
  }
  .view-product:hover {
    color: #1a8f80;
  }
  .view-all-button {
    display: block;
    width: fit-content;
    margin: 0 auto;
    padding: 1rem 2rem;
    background-color: #2e2b6e;
    color: white;
    text-decoration: none;
    border-radius: 50px;
    transition: background-color 0.2s ease;
    font-size: 18px;
    font-weight: 700;
  }
  .view-all-button:hover {
    background-color: #1f1c4d;
  }
  .swiper-button-next.swiper-button-disabled,
  .swiper-button-prev.swiper-button-disabled {
    opacity: 0;
  }
  .swiper-button-next,
  .swiper-button-prev {
    color: #2e2b6e;
    opacity: 0;
    transition: opacity 0.3s ease;
  }

  .swiper-pagination-bullet-active {
    background: #2e2b6e;
  }
  .swiper:hover .swiper-button-next,
  .swiper:hover .swiper-button-prev {
    opacity: 1;
  }
  .swiper-button-next:after,
  .swiper-button-prev:after {
    font-size: 24px;
    color: #03b0a7;
  }
  @media (max-width: 768px) {
    .hero h1 {
      font-size: 24px;
      text-align: center;
      min-width: unset;
      padding: 0 2rem;
      width: 100%;
    }
    .hero p {
      font-size: 14px;
      text-align: center;
      line-height: 19.12px;
    }
    .ipl-featured-products .container {
      padding: 2rem 0rem 1rem 0rem;
    }
    .swiper {
      padding: 24px !important;
    }
    .view-all-button {
      padding: 0.5rem 1rem;
      font-size: 14px;
      margin: 2rem auto 1rem auto;
    }
  }
  @media (min-width: 1800px) {
    .hero.flex {
      gap: 2rem;
    }
  }

  @media (min-width: 769px) {
    .swiper-button-prev.swiper-button-disabled,
    .swiper-button-next.swiper-button-disabled {
      opacity: 0;
      visibility: hidden;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }
    .hero.flex h1 {
      font-size: 40px;
    }
  }

  @media (max-width: 768px) {
    .product-card:hover {
      background-color: white !important;
    }

    .product-card:hover img {
      transform: none !important;
      transition: none !important;
    }

    .product-card:hover .product-info .view-product {
      background-color: transparent !important;
      border: none !important;
      color: #2bb7a4 !important;
    }

    .product-card .view-product {
      color: #2bb7a4 !important;
      transition: none !important;
    }
  }
</style>

<div class="ipl-featured-products">
  <div class="container">
    <section class="hero flex">
      {% if section.settings.heading_text %}
        <h1>{{ section.settings.heading_text }}</h1>
      {% endif %}
      `
      {% if section.settings.heading_text %}
        <p>{{ section.settings.body_text }}</p>
      {% endif %}
    </section>
    `
    {% assign featured_collection = collections.shop %}

    {% if featured_collection and featured_collection.products.size > 0 %}
      <div class="swiper">
        <div class="swiper-wrapper">
          {% for product in featured_collection.products %}
            {%- comment %}<locksmith:563c>{%- endcomment %}
            {%- capture var %}{% render 'locksmith-variables', scope: 'subject', subject: product, subject_parent: featured_collection, variable: 'transparent' %}{% endcapture -%}
            {%- if var == 'true' %}{% else %}{% continue %}{% endif -%}
            {%- comment %}</locksmith:563c>{%- endcomment %}
            <div class="swiper-slide">
              <a href="{{ product.url }}" class="product-card-link">
                <div class="product-card {% if product.title == 'Stress Test' %}min-height{% endif %}">
                  <img
                    src="{{ product.featured_image | img_url: '800x' }}"
                    alt="{{ product.title }}"
                    class="product-image"
                  >
                  <div class="product-info">
                    <span class="product-title">{{ product.title }}</span>
                    <span class="view-product">View product</span>
                  </div>
                </div>
              </a>
            </div>
          {% endfor %}
        </div>
        <div class="swiper-button-prev"></div>
        <div class="swiper-button-next"></div>
      </div>
    {% else %}
      <p>No featured products available.</p>
    {% endif %}

    {% if section.settings.button_text %}
      <a href="/collections/all" class="view-all-button">{{ section.settings.button_text }}</a>
    {% endif %}
  </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/9.2.0/swiper-bundle.min.js" defer></script>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    const swiper = new Swiper('.swiper', {
      slidesPerView: 1.5,
      spaceBetween: 20,
      pagination: {
        el: '.swiper-pagination',
        clickable: true,
      },
      navigation: {
        nextEl: '.swiper-button-next',
        prevEl: '.swiper-button-prev',
      },
      breakpoints: {
        320: {
          slidesPerView: 1.1,
        },
        768: {
          slidesPerView: 2.3,
        },
        1024: {
          slidesPerView: 2.5,
        },
        1440: {
          slidesPerView: 3.5,
        },
      },
    });
  });
</script>

{% schema %}
{
  "name": "IPL featured products",
  "settings": [
    {
      "type": "text",
      "id": "heading_text",
      "label": "Heading Text",
      "default": "Welcome to Our Store!"
    },
    {
      "type": "textarea",
      "id": "body_text",
      "label": "Body Text"
    },
    {
      "type": "text",
      "id": "button_text",
      "label": "Button Text",
      "default": "View all"
    }
  ],
  "presets": [
    {
      "name": "IPL featured products"
    }
  ]
}
{% endschema %}
